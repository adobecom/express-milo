<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Template X Promo Test</title>
    <link rel="stylesheet" href="express/code/blocks/template-x-promo/template-x-promo.css">
    <style>
        body { margin: 40px; font-family: Arial, sans-serif; }
        .section { margin: 20px 0; }
        
        /* Mock getLibs function */
        window.getLibs = () => '../../scripts';
        
        /* Mock createTag utility */
        window.createTag = (tag, attributes = {}, content = '') => {
            const element = document.createElement(tag);
            Object.entries(attributes).forEach(([key, value]) => {
                element.setAttribute(key, value);
            });
            if (content) element.textContent = content;
            return element;
        };
    </style>
</head>
<body>
    <h1>Template X Promo Test</h1>
    
    <!-- Test Case 1: Multiple templates -->
    <div class="section ax-template-x-promo">
        <div class="template-x-promo">
            <div class="recipe">
                collection=default&templateIds=89be31c0-4754-4264-83c3-58af0c3c66b9,e1ec965a-1726-4fa7-8b64-4d47df52ed5a,1a5d6d70-b1c5-4df4-8f8b-b7f8c9d0e1f2,2b6e7e81-c2d6-5ea5-9f9c-c8f9d0e1f2f3&limit=4
            </div>
        </div>
    </div>
    
    <!-- Test Case 2: Single template -->
    <div class="section ax-template-x-promo">
        <div class="template-x-promo">
            <div class="recipe">
                collection=default&templateIds=89be31c0-4754-4264-83c3-58af0c3c66b9&limit=1
            </div>
        </div>
    </div>
    
    <!-- Test Case 3: Query-based recipe -->
    <div class="section ax-template-x-promo">
        <div class="template-x-promo">
            <div class="recipe">
                q=good morning&collection=default&limit=6
            </div>
        </div>
    </div>
    
    <!-- Test Case 4: Direct API URL -->
    <div class="section ax-template-x-promo">
        <div class="template-x-promo">
            <div class="recipe">
                https://www.adobe.com/express-search-api-v3?filters=id==89be31c0-4754-4264-83c3-58af0c3c66b9,e1ec965a-1726-4fa7-8b64-4d47df52ed5a&collectionId=default&limit=4
            </div>
        </div>
    </div>

    <script type="module">
        // Mock getLibs globally
        window.getLibs = () => 'express/code/scripts';
        
        // Import and run the template-x-promo block
        import('./express/code/blocks/template-x-promo/template-x-promo.js').then(async (module) => {
            const decorate = module.default;
            const blocks = document.querySelectorAll('.template-x-promo');
            
            for (const block of blocks) {
                try {
                    await decorate(block);
                    console.log('✅ Block decorated successfully:', block);
                } catch (error) {
                    console.error('❌ Error decorating block:', error, block);
                }
            }
        }).catch(error => {
            console.error('❌ Error loading template-x-promo module:', error);
        });
    </script>
</body>
</html>
